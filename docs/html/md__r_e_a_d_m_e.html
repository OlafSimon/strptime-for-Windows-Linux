<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>strptime for Windows and Linux: strptime function for Windows (and Linux)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">strptime for Windows and Linux<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Portable strptime() and strftime() implementations capable to handle time zone information</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">strptime function for Windows (and Linux)</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a> Published under MIT License <br  />
</p>
<p><a href="https://github.com/OlafSimon/strptime-for-Windows-Linux">Repository</a> documentation under docs/docs.chm or (after download) docs/html/index.html.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Intention</h1>
<p>To my surprise the function 'strptime' to convert date and time from a string representation to a numerical calendrical representation available on Linux is not available on Window for C/C++ programming. Further more even time zone Information cannot be processed, even under Linux. <br  />
</p>
<p>My surprise was even larger not to find solutions on open source publications without having tremendous disadvantages. See section 'Inquiry' for more Information. <br  />
</p>
<p>As a result I took the time to implement strptime and strftime having the following features:</p>
<ul>
<li>Integration of time zone Information</li>
<li>Option for parsing calendrical strings without the need of a format string</li>
<li>Portable code using ANSI C</li>
<li>Language support (so far English and German, extensions easily possible)</li>
<li>Thread safety</li>
<li>Format string and function parameters compatible to standard C 'strftime' definition <br  />
 (as far as possible)</li>
</ul>
<p>In order to avoid Name conflicts with the Standard C libraries the functions are called:</p>
<ul>
<li><a class="el" href="group___lib_ob___time.html#gad1d8196cdd8e8803873607bea1b507ce" title="Converts a calendrical time dataset to a character string.">LibOb_strftime()</a></li>
<li><a class="el" href="group___lib_ob___time.html#gaf506fec1800ee4a11adfe6ff9a12a446" title="Converts a string containing calendrical time data to a numeric calendrical time data set.">LibOb_strptime()</a></li>
</ul>
<p>Additional functions for time operations and general string parsing are provided also. <br  />
</p>
<p>In case you are programming using C++ you may be interested in the <a href="https://github.com/OlafSimon/cTime">cTime class</a> providing even more simple usage.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Usage of LibOb_strptime and LibOb_strftime</h1>
<p>The following code snippet demonstrates the usage of the implemented functions. The function LibOb_strftime needed two additional parameters to support time zone and language. Both parameters may be set to 'zero' if not needed. </p><pre class="fragment">#include "LibCpp/Time/cTime.h"

using namespace LibCpp;
using namespace std;

int main()
{
    printf("------- Usage of strptime / strftime ---------\n");
    char timeStr[64];
    struct tm tp;

    time_t now = time(0);
    localtime_s(&amp;tp,&amp;now);
    stTimeZone localZone = LibOb_localTimeZone(0);

    LibOb_strftime(timeStr, 64, 0, &amp;tp, &amp;localZone, 0);

    printf("Current time is: %s\n", timeStr);
    LibOb_strftime(timeStr, 64, "%A %Y-%m-%d %H:%M:%S %Z", &amp;tp, &amp;localZone, 0);
    printf("or formatted: %s\n", timeStr);

    //string dateString = "2022-9-15";
    //string dateString = "15:32:10";
    //string dateString = "15:32:10DST";
    //string dateString = "15:32:10 DST";
    //string dateString = "15:32:10 DST +02:00";
    //string dateString = "2007-08-31T16:47+01:45";
    //string dateString = "2007-08-31#16:47:36#UTC#+01:00";
    //string dateString = "03/15/2023";
    //string dateString = "1.2.2024";
    //string dateString = "8:23 Uhr am 1. 2. 2024 CEST";
    //string dateString = "1. Februar 2024 um 10:11Uhr";
    //string dateString = "May 15th 2019";

    const char* dateString = "May 15, 2019";
    printf("Test input: %s\n", dateString);

    LibOb_strptime(dateString, 0, &amp;tp, &amp;localZone);

    printf("Numerical calendar data: year %d, month %d, day %d\n", (int)tp.tm_year+1900, (int)tp.tm_mon+1, (int)tp.tm_mday);
    fflush(stdout);
}
</pre> <h1><a class="anchor" id="autotoc_md3"></a>
Installation</h1>
<p>The following files need to be included to your C/C++ project:</p>
<ul>
<li><a class="el" href="_lib_ob__strptime_8h.html" title="See LibOb_strptime.c.">src/LibOb_strptime.h</a></li>
<li>src/LibOb_strptime.cpp</li>
</ul>
<h1><a class="anchor" id="autotoc_md4"></a>
Further documentation</h1>
<p>This repository and documentation is a part of the larger <a href="https://github.com/OlafSimon/cTime">cTime class</a> library on github.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Inquiry</h1>
<p>An intense discussion on the issue of having 'strptime' available on Windows can be found on stack-overflow under <a href="https://stackoverflow.com/questions/321849/strptime-equivalent-on-windows">strptime-equivalent-on-windows</a>. <br  />
</p>
<p>Several proposals are listed but all of them have some kind of disadvantages.</p>
<ul>
<li>Usage of 'sscanf'</li>
</ul>
<p>This solution is more a work around but does not support the comfortable use of 'strptime'.</p>
<ul>
<li>Usage of 'std::get_time()'</li>
</ul>
<p>The resulting data is delivered through the struct tm, which has no entry for time zone data. Thus time zone is not sufficiently supported.</p>
<ul>
<li>NetBSD publication by Klaus Klein and David Laight</li>
</ul>
<p>The 'strptime' implementation can be found on <a href="http://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/time/strptime.c?rev=HEAD">NetBsd</a> and does have support for time zone data which is the mayor feature to be provided. This implementation has a dependence of 'tzfile.h', which seems to be part of the <a href="ttp://www.iana.org/time-zones">iana time zone database</a>. The 'struct tm' seems to be enlarged by the TM_ZONE entry. Named time zones seem to be limited to US zones. At least Installation is a bit complicated and I expect name conflicts with the C/C++ standard libraries.</p>
<ul>
<li>'boost' library</li>
</ul>
<p>You get a dependence of a large library, which probably not desired for just the implementation of two functions. I didn't check what actually can be done or can't be done for that reason. "swick" and "amwinter" also raised that issue.</p>
<ul>
<li>CStringA::FormatV</li>
</ul>
<p>is a Microsoft specific implementation and not portable. Same applies to the class CTime.</p>
<ul>
<li>Implementation of P. J. Miller</li>
</ul>
<p>The <a href="https://github.com/p-j-miller/date-time">implementation</a> from P. J. Miller is the (by far) best approach addressing time zone support and many other of the desired features. The main reason for not just adding language support and automated parsing is the chosen concept of passing the time zone Information through a global variable and thus loosing the abaility of thread safety. Alltogether I decided not to develop a solution on top of that implementation. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
